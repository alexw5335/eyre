namespace eyre

var instanceVersion: dword = 0

proc main {
	sub rsp, 40

	lea rcx, ["vulkan-1.dll"]
	dllcall LoadLibraryA
	mov rsi, rax

	lea rcx, ["Vulkan DLL: %p\n"]
	mov rdx, rsi
	dllcall printf

	mov rcx, rsi
	lea rdx, ["vkEnumerateInstanceVersion"]
	dllcall GetProcAddress
	mov rdi, rax

	lea rcx, ["vkEnumerateInstanceVersion: %p\n"]
	mov rdx, rdi
	dllcall printf

	lea rcx, [instanceVersion]
	call rdi

	lea rcx, ["Instance version: %d\n"]
	mov edx, [instanceVersion]
	dllcall printf

	dllcall ExitProcess
}